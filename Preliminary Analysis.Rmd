---
title: "Preliminary Analysis"
author: "Bradley Hopkins, Matthew Hoctor"
date: "2/6/2021"
output:
  html_document:
    number_sections: yes
    theme: lumen
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: no
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
#library(tidyverse)
#library(ggplot2)
#library(ggthemes)
#library(gridExtra)
library(describedata)
#library(readxl)
#library(CarletonStats)
#library(pwr)
#library(BSDA)
#library(exact2x2)
```

# Project overview

A project overview can be found in the README.md document on the main github project page: [link](https://github.com/matthew-hoctor/BSTA512-Project)

# Import the dataset

Import the maternal smoking dataset:
```{r maternal smoking dataset, message = FALSE} 
CHDS <- read.csv("CHDS.csv")
```

# Descriptions of individual variables

## Summary statistics for each variable:

```{r}
summary(CHDS)
```

## Birth Weight plots

```{r}
hist(CHDS$bwt, main = paste("Histogram of Birth Weight"), xlab = "Birth Weight (lbs)")
boxplot(CHDS$bwt, main = "Box Plot of Birth Weight", ylab = "Birth Weight (lbs)")
```

## Gestational age plots

```{r}
hist(CHDS$gestwks, main = paste("Histogram of Gestational Age"), xlab = "Gestational Age (weeks)")
boxplot(CHDS$bwt, main = "Box Plot of Gestational Age", ylab = "Gestational Age (weeks)")
```

## Maternal Age plots

```{r}
hist(CHDS$age, main = paste("Histogram of Maternal Age"), xlab = "Maternal Age (years)")
boxplot(CHDS$age, main = "Box Plot of Maternal Age", ylab = "Maternal Age (years)")
```

## Cigarettes smoked plots

```{r}
hist(CHDS$mnocig, main = paste("Histogram of Maternal Smoking"), xlab = "Maternal Smoking (cigarettes/day)")
boxplot(CHDS$mnocig, main = "Box Plot of Maternal Smoking", ylab = "Maternal Smoking (cigarettes/day)")
```

## Maternal height plots

```{r}
hist(CHDS$mheight, main = paste("Histogram of Maternal Height"), xlab = "Maternal Height (in)")
boxplot(CHDS$mheight, main = "Box Plot of Maternal Height", ylab = "Maternal Height (in)")
```

## Maternal pre-partum weight plots

```{r}
hist(CHDS$mppwt, main = paste("Histogram of Maternal Weight"), xlab = "Maternal Pre-Partum Weight (lbs)")
boxplot(CHDS$mppwt, main = "Box Plot of Maternal Weight", ylab = "Maternal Pre-Partum Weight (lbs)")
```

# Generation of new variables of interest

## BMI

The following R Code creates a new variable for body mass index from the maternal weight and pre-partum height data:

```{r}
CHDS$BMI <- 703 * CHDS$mppwt / ((CHDS$mheight)^2)
```

## BMI category

The following R code creates a new variable for BMI category:

```{r}
CHDS$BMI_cat <- 
  ifelse(CHDS$BMI < 18.5, 0, 
  ifelse(CHDS$BMI < 25, 1,
  ifelse(CHDS$BMI < 30, 2,
  ifelse(CHDS$BMI < 35, 3,
  ifelse(CHDS$BMI < 40, 4, 
  5)))))
```

Note that 0 corresponds to underweight, 1 to normal weight, 2 to overweight, 3 to class I obese, 4 to class II obese, and 5 to class III obese.

## Smoking category

The following R code creates a new variable for smoking category.  Patients are categorized as 0, non-smokers; 1, light smokers 1-9 cigarettes/day; 2, moderate smokers, 10-19 cigarettes/day; or 3, heavy smokers 20+ cigarettes/day:

```{r}
CHDS$SMK_cat <-
  ifelse(CHDS$mnocig == 0, 0,
  ifelse(CHDS$mnocig < 10, 1,
  ifelse(CHDS$mnocig < 20, 2, 
  3)))
```

## Birth weight category

# Scatter plot matrix

The following R code creates a scatter plot matrix:

```{r}
pairs(~bwt+gestwks+age+mnocig+mheight+mppwt+BMI+BMI_cat+SMK_cat, data = CHDS, main = "Scatterplot Matrix")
```

# Check normality of response data

## Birth Weight

We can perform the Shapiro-Wilk test to to test for normality:

```{r}
shapiro.test(CHDS$bwt)
```

This borderline p-value suggests that more investigation may be needed.  A Q-Q plot and boxplot may help:

```{r}
qqnorm(CHDS$bwt)
boxplot(CHDS$bwt)
```

These results suggest that birth weight is normally distributed. For completeness we can check the gladder function:

```{r}
gladder(CHDS$bwt)
```

None of the transformed distributions look particularly better than the origional distribution.

## Gestational Age

We can perform the Shapiro-Wilk test to to test for normality:

```{r}
shapiro.test(CHDS$gestwks)

gladder(CHDS$gestwks)
```

This is very consistent with normal distribution.  We will do a Q-Q plot and boxplot for completeness:

```{r}
qqnorm(CHDS$gestwks)
boxplot(CHDS$gestwks)
```

These results suggest that gestational age is normally distributed.

# References:

See [literature review section](https://github.com/matthew-hoctor/BSTA512-Project#literature-review)